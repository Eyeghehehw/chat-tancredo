<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Chat Tancredo</title>
<style>
  body {
    font-family: Arial, sans-serif;
    display: flex;
    flex-direction: column;
    height: 100vh;
    margin: 0;
    transition: background 0.3s, color 0.3s;
  }

  header {
    padding: 15px;
    text-align: center;
    font-size: 1.5em;
    font-weight: bold;
    transition: background 0.3s, color 0.3s;
  }

  #chat {
    flex: 1;
    padding: 10px;
    overflow-y: auto;
    display: flex;
    flex-direction: column;
    gap: 8px;
    transition: background 0.3s;
  }

  .message {
    max-width: 75%;
    padding: 10px 14px;
    border-radius: 12px;
    word-wrap: break-word;
    line-height: 1.4;
    opacity: 0;
    transform: translateX(-50px);
    animation: slideIn 0.4s forwards;
  }

  .user { align-self: flex-end; }
  .bot { align-self: flex-start; }

  @keyframes slideIn {
    to { opacity: 1; transform: translateX(0); }
  }

  #inputArea {
    display: flex;
    padding: 10px;
  }

  #userInput {
    flex: 1;
    padding: 10px;
    border-radius: 8px;
    border: 2px solid;
    font-size: 16px;
    transition: border-color 0.3s, background 0.3s, color 0.3s;
  }

  #sendBtn, #themeBtn, #clearBtn {
    padding: 10px 15px;
    margin-left: 5px;
    border: none;
    border-radius: 8px;
    font-size: 16px;
    cursor: pointer;
    transition: background 0.3s, color 0.3s;
  }

  footer {
    text-align: right;
    padding: 5px 15px;
    font-size: 0.9em;
    color: gray;
  }

  #fraseMotivacional {
    text-align: center;
    font-style: italic;
    color: #555;
    margin-bottom: 5px;
    transition: color 0.3s;
  }

  /* ---------- Tema Claro ---------- */
  body.claro { background: #f5f5f5; color: #000; }
  body.claro header { background: #007bff; color: #fff; }
  body.claro #chat { background: #fff; }
  body.claro .user { background: #007bff; color: #fff; }
  body.claro .bot { background: #28a745; color: #fff; }
  body.claro #userInput { border-color: #007bff; }
  body.claro #sendBtn { background: #007bff; color: #fff; }
  body.claro #themeBtn { background: #6c757d; color: #fff; }
  body.claro #clearBtn { background: #dc3545; color: #fff; }

  /* ---------- Tema Escuro ---------- */
  body.escuro { background: #1e1e1e; color: #fff; }
  body.escuro header { background: #333; color: #fff; }
  body.escuro #chat { background: #2c2c2c; }
  body.escuro .user { background: #3399ff; color: #fff; }
  body.escuro .bot { background: #33cc77; color: #fff; }
  body.escuro #userInput { border-color: #3399ff; background: #444; color: #fff; }
  body.escuro #sendBtn { background: #3399ff; color: #fff; }
  body.escuro #themeBtn { background: #ff9900; color: #fff; }
  body.escuro #clearBtn { background: #dc3545; color: #fff; }

</style>
</head>
<body class="claro">

<header>ü§ñ Chat Tancredo</header>

<div id="fraseMotivacional"></div>
<div id="chat"></div>

<div id="inputArea">
  <input type="text" id="userInput" placeholder="Digite algo..." autofocus>
  <button id="sendBtn">Enviar</button>
  <button id="clearBtn">Limpar</button>
  <button id="themeBtn">Tema</button>
</div>

<footer>By: Gabriel Almeida 1 - EMTI</footer>

<script>
const chat = document.getElementById("chat");
const input = document.getElementById("userInput");
const sendBtn = document.getElementById("sendBtn");
const themeBtn = document.getElementById("themeBtn");
const clearBtn = document.getElementById("clearBtn");
const fraseDiv = document.getElementById("fraseMotivacional");

let temaAtual = 0; 
const temas = ["claro","escuro"];
let conversa = [];

const frasesMotivacionaisOriginais = [
  "Acredite em voc√™ e tudo ser√° poss√≠vel!",
  "Pequenos passos tamb√©m levam longe.",
  "Nunca √© tarde para recome√ßar.",
  "Voc√™ √© mais forte do que imagina.",
  "Fa√ßa hoje algo que seu futuro agrade√ßa."
];
let frasesMotivacionais = [...frasesMotivacionaisOriginais];

function addMessage(text, sender) {
  const div = document.createElement("div");
  div.className = "message " + sender;
  div.textContent = text;
  chat.appendChild(div);
  chat.scrollTop = chat.scrollHeight;

  // Atualizar frase motivacional
  if (frasesMotivacionais.length === 0) frasesMotivacionais = [...frasesMotivacionaisOriginais];
  const idx = Math.floor(Math.random() * frasesMotivacionais.length);
  fraseDiv.textContent = frasesMotivacionais[idx];
  frasesMotivacionais.splice(idx,1);
}

function equacaoSegundoGrau(a,b,c){
  const delta = b*b - 4*a*c;
  if (delta < 0) return "A equa√ß√£o n√£o tem ra√≠zes reais üòø";
  if (delta === 0) return "A raiz dupla √© " + (-b/(2*a));
  let x1 = (-b + Math.sqrt(delta))/(2*a);
  let x2 = (-b - Math.sqrt(delta))/(2*a);
  return As ra√≠zes s√£o ${x1} e ${x2};
}

function calcularExpressao(msg) {
  try {
    // Substitui multiplos sinais escritos por s√≠mbolos
    msg = msg.replace(/vezes|x/g,'*').replace(/mais/g,'+').replace(/menos/g,'-').replace(/dividido por/g,'/');
    // S√≥ permite n√∫meros e operadores
    if (/^[0-9+\-*/().\s]+$/.test(msg)) {
      return "Resultado: " + eval(msg);
    }
  } catch {}
  return null;
}

function botResponse(msg) {
  msg = msg.toLowerCase().trim();

  // Resposta emocional
  if (msg.includes("mal") || msg.includes("triste") || msg.includes("depressivo")) {
    return "Conversa com o Greguinho üíï";
  }

  // Equa√ß√£o do 2¬∫ grau
  if (msg.startsWith("equacao")) {
    try {
      let [_, a, b, c] = msg.split(" ");
      return equacaoSegundoGrau(parseFloat(a),parseFloat(b),parseFloat(c));
    } catch { return "Use: equacao a b c (ex: equacao 1 -3 2)"; }
  }

  // Pot√™ncia
  if (msg.startsWith("potencia")) {
    try {
      let [_, base, exp] = msg.split(" ");
      return ${base} ^ ${exp} = ${Math.pow(parseFloat(base),parseFloat(exp))};
    } catch { return "Use: potencia base expoente (ex: potencia 2 3)"; }
  }

  // Raiz
  if (msg.startsWith("raiz")) {
    try {
      let [_, valor] = msg.split(" ");
      valor = parseFloat(valor);
      if (valor < 0) return "N√£o existe raiz real üòø";
      return ‚àö${valor} = ${Math.sqrt(valor)};
    } catch { return "Use: raiz numero (ex: raiz 25)"; }
  }

  // Contas b√°sicas +, -, *, /
  const resultadoConta = calcularExpressao(msg);
  if (resultadoConta) return resultadoConta;

  // Cumprimentos
  if (msg.includes("oi")) return "Oi! Como voc√™ est√°? üòÑ";
  if (msg.includes("tudo bem")) return "Tudo √≥timo, e voc√™?";
  if (msg.includes("nome")) return "Eu sou o Chat Tancredo!";

  // Hist√≥rico
  if (msg.includes("hist√≥rico") || msg.includes("conversa")) {
    return conversa.map(c => (c.sender==="user"?"Voc√™: ":"Chatbot: ") + c.text).join("\n");
  }

  // Respostas divertidas
  const respostas = [
    "Interessante! üòé",
    "Hmm, me conta mais!",
    "üí° Boa ideia!",
    "üòÇ Haha, adorei!",
    "ü§î Vou pensar sobre isso..."
  ];
  return respostas[Math.floor(Math.random()*respostas.length)];
}

function sendMessage() {
  const userMsg = input.value;
  if (!userMsg) return;
  addMessage(userMsg,"user");
  conversa.push({sender:"user", text:userMsg});

  const resposta = botResponse(userMsg);
  addMessage(resposta,"bot");
  conversa.push({sender:"bot", text:resposta});

  input.value = "";
}

function toggleTheme(){
  temaAtual = (temaAtual + 1) % temas.length;
  document.body.className = temas[temaAtual];
}

function clearChat(){
  chat.innerHTML = "";
  conversa = [];
  frasesMotivacionais = [...frasesMotivacionaisOriginais];
  fraseDiv.textContent = "";
}

sendBtn.addEventListener("click", sendMessage);
input.addEventListener("keypress", e => { if(e.key==="Enter") sendMessage(); });
themeBtn.addEventListener("click", toggleTheme);
clearBtn.addEventListener("click", clearChat);

</script>
</body>
</html>
